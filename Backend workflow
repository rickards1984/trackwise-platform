name: ci-backend
on:
pull_request:
paths: [ 'backend/**' ]
push:
branches: [ main ]
paths: [ 'backend/**' ]

jobs:
build-and-test:
runs-on: ubuntu-latest
defaults:
run:
working-directory: backend
steps:
- uses: actions/checkout@v4
- uses: actions/setup-node@v4
with:
node-version: '20'
cache: 'npm'
cache-dependency-path: 'backend/package-lock.json'
- run: npm ci || npm install
- name: Run unit tests if present
run: |
if npm run | grep -qi " test"; then
npm test
else
echo "No test script; skipping"
fi
